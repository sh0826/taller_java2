<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/templates/clienteLayout.xhtml"
                xmlns:p="http://primefaces.org/ui">

    <ui:define name="contenido">
    <h:head>
        <title>Administrar Boletas</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"/>
        <style>
            body {
                background: #111 !important;
                color: #C89B3C !important;
            }
            
            .dashboard-container {
                margin: 20px 0;
                padding: 20px;
                background: #1a1a1a;
                border: 1px solid #333;
                border-radius: 5px;
            }
            
            h2 {
                color: #C89B3C !important;
            }
            
            .card {
                background: #1a1a1a !important;
                border: 1px solid #333 !important;
            }
            
            .card-header {
                background: #000 !important;
                color: #C89B3C !important;
                border-bottom: 1px solid #333 !important;
            }
            
            .card-body {
                background: #1a1a1a !important;
            }
            
            .form-control {
                background: #262626 !important;
                border: 1px solid #444 !important;
                color: #eee !important;
            }
            
            .form-control:focus {
                background: #262626 !important;
                border-color: #C89B3C !important;
                color: #eee !important;
                box-shadow: 0 0 5px rgba(200, 155, 60, 0.3) !important;
            }
            
            h:outputLabel {
                color: #C89B3C !important;
            }
            
            .nav-item {
                color: #eee;
                padding: 10px 18px;
                text-decoration: none;
                background: #262626;
                border-radius: 5px;
                transition: 0.2s;
                display: inline-block;
                border: none;
            }

            .nav-item:hover {
                background: #C89B3C;
                color: black;
                font-weight: bold;
            }
            
            .btn-primary {
                background: #6D0823 !important;
                border-color: #6D0823 !important;
                color: white !important;
            }
            
            .btn-primary:hover {
                background: #C89B3C !important;
                border-color: #C89B3C !important;
                color: black !important;
            }
            
            .btn-secondary {
                background: #262626 !important;
                border-color: #333 !important;
                color: #C89B3C !important;
            }
            
            .btn-secondary:hover {
                background: #333 !important;
                color: #C89B3C !important;
            }
            
            .text-primary {
                color: #C89B3C !important;
            }
            
            .text-secondary {
                color: #C89B3C !important;
            }
            
            .text-success {
                color: #C89B3C !important;
            }
            
            .text-danger {
                color: #ff6b6b !important;
            }
      
            .tabla-dark th, .tabla-dark td {
                background-color: #111 !important;
                color: white !important;
                border: 1px solid #333 !important;
                padding: 12px;
                text-align: center;
            }

            .tabla-dark th {
                background-color: #000 !important;
                color: #C89B3C !important;
                font-weight: bold;
                font-size: 16px;
            }

            .tabla-dark tr:nth-child(even) td {
                background-color: #1a1a1a !important;
            }
            
            .tabla-dark tr:hover td {
                background-color: #262626 !important;
            }
            
            .table {
                background: #111 !important;
            }
        </style>
    </h:head>

    <h:body style="background-color: #111 !important;">
        <div class="dashboard-container">
            <f:event type="preRenderView" listener="#{boletaBean.listar}"/>
            
            <h:form class="container">
                <!-- Botón Menú Anterior arriba -->
                <div class="mb-3" style="margin-top: 20px;">
                    <h:commandLink value="Menú Anterior"
                                   styleClass="btn btn-secondary"
                                   action="/faces/cliente/index" />
                </div>
                
                <h2 class="text-center mb-4" style="color: #C89B3C !important;">Administrar Boletas</h2>

                <div class="mb-4 text-center" style="display: flex; justify-content: center; gap: 0;">
                    <h:commandLink value="Nueva Boleta" 
                                   styleClass="nav-item" 
                                   style="margin: 0; border-radius: 5px;"
                                   action="nuevo" />
                </div>
                
                <br/><br/>
                
                <div class="card mb-3">
                    <div class="card-header">
                        <h5 class="mb-0" style="color: #C89B3C;">Filtros de Búsqueda</h5>
                    </div>
                    <div class="card-body">
                        <h:panelGrid columns="4" columnClasses="col-md-3,col-md-3,col-md-3,col-md-3">
                            <h:outputLabel value="Nombre del Evento:" style="color: #C89B3C;" />
                            <p:inputText value="#{boletaBean.filtroEvento}" 
                                        styleClass="form-control" 
                                        placeholder="Buscar por evento..." />

                            <h:outputLabel value="Precio:" style="color: #C89B3C;" />
                            <p:inputText value="#{boletaBean.filtroPrecio}" 
                                        styleClass="form-control" 
                                        placeholder="Ej: 100.00" />

                            <h:outputLabel value="Cantidad de Boletos:" style="color: #C89B3C;" />
                            <p:inputText value="#{boletaBean.filtroCantidad}" 
                                        styleClass="form-control" 
                                        placeholder="Ej: 2" />
                        </h:panelGrid>
                        <br/>
                        <h:commandButton value="Buscar" 
                                        action="#{boletaBean.buscarPorEvento}" 
                                        class="btn btn-primary" />
                        <h:commandButton value="Limpiar Filtros" 
                                        action="#{boletaBean.limpiarFiltros}" 
                                        class="btn btn-secondary" 
                                        style="margin-left: 10px;" />
                    </div>
                </div>

            <div class="mb-3">
        <h2 class="text-center text-primary">Administrar Boletas</h2>            
            <h:form>
                
                <h:dataTable value="#{boletaBean.listaFiltrada}" var="boleta" 
                            styleClass="tabla-dark w-100"
                            headerClass="tabla-dark"
                            rowClasses="tabla-dark">
                    <h:column>
                        <f:facet name="header">
                            <h:outputLabel value="ID Boleta" />
                        </f:facet>
                        <h:outputText value="#{boleta.id_boleta}" />
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">
                            <h:outputLabel value="Precio" />
                        </f:facet>
                        <h:outputText value="#{boleta.precio_boleta}">
                            <f:convertNumber pattern="#,##0.00" />
                        </h:outputText>
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">
                            <h:outputLabel value="Cantidad Boletos" />
                        </f:facet>
                        <h:outputText value="#{boleta.cantidad_boletos}" />
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">
                            <h:outputLabel value="Usuario" />
                        </f:facet>
                        <h:outputText value="#{boletaBean.usuarioNombre}" />
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">
                            <h:outputLabel value="Evento" />
                        </f:facet>
                        <h:outputText value="#{boleta.even.nombre_evento}" />
                    </h:column>
                    
                    <h:column>
                        <f:facet name="header">
                            <h:outputLabel value="Opciones" />
                        </f:facet>
                        <h:commandLink value="Editar" 
                                       styleClass="text-success"  
                                       actionListener="#{boletaBean.buscar(boleta.id_boleta)}" 
                                       action="editar" />
                        <h:commandLink value="Eliminar" 
                                       styleClass="text-danger" 
                                       style="margin-left: 15px;" 
                                       action="#{boletaBean.eliminar(boleta.id_boleta)}" 
                                       onclick="return confirm('¿Está seguro de ELIMINAR la Boleta #{boleta.id_boleta}?');" />
                    </h:column>
                </h:dataTable>            
            </h:form>
        </div>
        </div>
    </h:body>
</ui:define>

</ui:composition>

