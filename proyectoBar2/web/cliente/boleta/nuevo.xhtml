<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    template="/templates/clienteLayout.xhtml" xmlns:p="http://primefaces.org/ui">

    <ui:define name="contenido">
        <f:metadata>
            <f:event type="preRenderView" listener="#{boletaBean.preRender}" />
        </f:metadata>

        <h:head>
            <title>Nueva Boleta</title>
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" />
            <style>
                body {
                    background: #111 !important;
                    color: #C89B3C !important;
                }

                .dashboard-container {
                    margin: 20px 0;
                    padding: 20px;
                    background: #1a1a1a;
                    border: 1px solid #333;
                    border-radius: 5px;
                }

                h2 {
                    color: #C89B3C !important;
                }

                .nav-item {
                    color: #eee !important;
                    padding: 10px 18px;
                    text-decoration: none !important;
                    background: #262626;
                    border-radius: 5px;
                    transition: 0.2s;
                    display: inline-block;
                    border: none;
                }

                .nav-item:hover {
                    background: #C89B3C !important;
                    color: black !important;
                    font-weight: bold;
                }

                a.nav-item {
                    color: #eee !important;
                    text-decoration: none !important;
                }

                a.nav-item:hover {
                    background: #C89B3C !important;
                    color: black !important;
                    font-weight: bold;
                }

                .form-label {
                    color: #C89B3C !important;
                    font-weight: bold;
                    margin-bottom: 8px;
                }

                .form-control,
                .form-select {
                    background: #262626 !important;
                    color: #eee !important;
                    border: 1px solid #444 !important;
                    padding: 10px 12px;
                    width: 100%;
                }

                .form-control:focus,
                .form-select:focus {
                    background: #262626 !important;
                    color: #eee !important;
                    border-color: #C89B3C !important;
                    box-shadow: 0 0 5px rgba(200, 155, 60, 0.3);
                    outline: none;
                }

                .btn-primary {
                    background: #6D0823 !important;
                    border-color: #6D0823 !important;
                    color: white !important;
                    padding: 10px 20px;
                }

                .btn-primary:hover {
                    background: #C89B3C !important;
                    border-color: #C89B3C !important;
                    color: black !important;
                    font-weight: bold;
                }

                .btn-secondary {
                    background: #262626 !important;
                    border-color: #333 !important;
                    color: #C89B3C !important;
                    padding: 10px 20px;
                }

                .btn-secondary:hover {
                    background: #333 !important;
                    color: #C89B3C !important;
                }

                .text-danger {
                    color: #ff6b6b !important;
                }

                .form-text {
                    color: #C89B3C !important;
                    font-size: 12px;
                }
            </style>
        </h:head>
        <h:body style="background-color: #111 !important;">
            <div class="dashboard-container">
                <!-- Botón Menú Anterior arriba -->
                <div class="mb-3" style="margin-top: 20px;">
                    <h:form>
                        <h:commandLink value="Menú Anterior" styleClass="nav-item"
                            action="/faces/cliente/boleta/index?faces-redirect=true" />
                    </h:form>
                </div>

                <h2 class="text-center mb-4" style="color: #C89B3C !important;">Nueva Boleta</h2>

                <h:form id="frmBoleta">
                    <p:messages id="messages" showDetail="true" closable="true" />

                    <!-- IDs ocultos -->
                    <h:inputHidden value="#{boletaBean.boleta.id_boleta}" />
                    <h:inputHidden value="#{boletaBean.boleta.id_usuario}" />

                    <div class="mb-3">
                        <h:outputLabel for="evento" value="Evento:" styleClass="form-label" />
                        <h:selectOneMenu id="evento" value="#{boletaBean.boleta.id_evento}" styleClass="form-select">
                            <f:selectItem itemLabel="Seleccione un evento..." itemValue="-1" />
                            <f:selectItems value="#{boletaBean.lstEven}" var="evento"
                                itemLabel="#{evento.nombre_evento}" itemValue="#{evento.id_evento}" />
                            <f:ajax listener="#{boletaBean.cargarPrecioEvento}" render="precio" />
                        </h:selectOneMenu>
                        <h:message for="evento" styleClass="text-danger" />
                    </div>

                    <div class="mb-3">
                        <h:outputLabel for="precio" value="Precio:" styleClass="form-label" />
                        <h:inputText id="precio" value="#{boletaBean.boleta.precio_boleta}" readonly="true"
                            styleClass="form-control">
                            <f:convertNumber type="currency" currencySymbol="$" locale="es_CO" />
                        </h:inputText>
                    </div>

                    <div class="mb-3">
                        <h:outputLabel for="cantidad" value="Cantidad de Boletos:" styleClass="form-label" />
                        <h:inputText id="cantidad" value="#{boletaBean.boleta.cantidad_boletos}"
                            styleClass="form-control" required="true"
                            requiredMessage="Debe especificar la cantidad de boletos" />
                        <h:message for="cantidad" styleClass="text-danger" />
                    </div>

                    <div class="mb-3">
                        <h:outputLabel for="idUsuario" value="Usuario:" styleClass="form-label" />
                        <h:inputText id="idUsuario" value="#{boletaBean.usuarioNombre}" disabled="true"
                            styleClass="form-control" />
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <h:commandButton value="Guardar" action="#{boletaBean.guardar}" styleClass="btn btn-primary" />
                        <h:commandButton value="Cancelar" action="/cliente/boleta/index?faces-redirect=true"
                            styleClass="btn btn-secondary" immediate="true" />
                    </div>
                </h:form>
            </div>
        </h:body>
    </ui:define>

</ui:composition>